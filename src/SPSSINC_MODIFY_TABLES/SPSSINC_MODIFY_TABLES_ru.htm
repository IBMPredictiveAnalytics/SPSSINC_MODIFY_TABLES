<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Модифицировать таблицы</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>
<body>
<h1>Модифицировать таблицы</h1>
Модифицировать таблицы применяет стили вывода и форматирование к мобильным таблицам.  Вы можете
<ul>
<li>управлять внешним видом отдельных ячеек данных, а также меток строк и столбцов.
<li>задавать ширину отдельных столбцов и скрывать их.
<li>вращать измерения таблиц.
</ul>
Можно выбрать конкретные типы таблиц в средстве просмотра, к которым эти модификации будут применены, а также рамки их применения.  
<p class="bullet">&bull;На облегченные таблицы в версии 19 эта команда не действует, поскольку их нельзя редактировать.  Это ограничение не применяется к более новым версиям.

<p>Спецификация отбора состоит из следующих элементов:
<ul>
<li>Типы таблиц для обработки.  Типы являются OMS подтипами таблиц.</li>
<li>Измерение: строки или столбцы (по умолчанию столбцы).</li>
<li>Конкретные строки или столбцы, включая все.</li>
<li>Область применения прикладной программы: от предшествующей команды или весь вывод (по умолчанию - предшествующий вывод).</li>
<li>Необязательные, задаваемые значениями критерии отбора, такие, как значение в ячейке должно быть больше, чем 2.</li>
<li>Необязательный выбор ячеек с маркерами значимости</li>
</ul>
Спецификации действий:
<ul>
<li>Скрыть указанные строки или столбцы.</li>
<li>Задать ширину столбцов и/или ширину меток строк.</li>
<li>Задать стиль шрифта как обычный, полужирный, курсив или полужирный курсив.</li>
<li>Задать цвет шрифта.</li>
<li>Задать цвет фона.</li>
<li>Применить пользовательские действия к указанным ячейкам.</li>
</ul>
Спецификации выбора задаются в главном диалоговом окне и в диалоговом окне Значимость.  Спецификации действий задаются во вспомогательном диалоговом окне Действия.  Если не задавать какие-либо действия или если не будут найдены таблицы, удовлетворяющие критериям отбора, команда не выполнит никаких действий без выдачи предупреждения об этом.
<h2>Отбор таблиц, измерения, а также строк или столбцов</h2>

<p>Введите OMS-подтип таблицы в поле <i>Подтип таблицы</i>.
Подтип можно найти, щелкнув правой кнопкой мыши в схеме на экземпляре таблицы и выбирая <i>Копировать OMS-подтип</i> из списка в <i>Утилиты>OMS-идентификаторы</i>.  Введите *, чтобы выбрать все подтипы.</p>
<p>
Выберите <i>Столбцы</i> или <i>Строки</i>, чтобы задать измерение таблицы для обработки.  Ширина может быть задана только для измерения столбца, а ширину метки строки можно задать независимо от измерения.
<p>
В поле <i>Выбранные столбцы или строки</i> введите через пробел список отдельных строк или столбцов для обработки, или же введите "&lt;&lt;ALL&gt;&gt;" для обработки всего измерения (включите кавычки и ALL в верхнем регистре).
Строки или столбцы могут быть заданы с помощью номеров положения или текста меток в кавычках.
<p>Для <i>Уровень для сопоставления текста:</i>, первая (самая внешняя) строка или столбец - это 0.  Используйте
отрицательные числа для обратного отсчета с конца: -1 соответствует последней (внутренней) строке или последнему
столбцу.  Для сопоставления текста меток заключите текст в кавычки.  Воспроизведите точно регистр букв и пробелы метки.  Числовые и текстовые спецификации можно объединять.  Например,<br>
2 3 "Upper"<br>
выбирает строки или столбцы 2, 3 и одну с меткой "Upper".  Если никакие элементы не удовлетворяют спецификации, она игнорируется.  Строки и столбцы считаются, начиная с самого дальнего внутреннего уровня таблицы.
<p>Если включен переключатель <i>Текст выше - это паттерны</i>, каждое текстовое поле выше (кроме &lt;&lt;ALL&gt;&gt;) рассматривается как регулярное выражение.
Например, <i>"Sig\."</i> будет соответствовать любому тексту меток, который содержит <i>Sig.</i>.  В противном случае метка сопоставляется побуквенно с заданным текстом.
В качестве регулярного выражения это будет соответствовать <i>Asympt Sig.</i> или <i>Two-tailed Sig.</i>, но не <i>Asympt Sig</i> (так как нет точки).
Если рассматривать это как обычный текст, то соответствий нет.
Можно использовать любые регулярные выражения Python.  Шаблоны чувствительны к регистру и учитывают региональные особенности.
<p>Элементы, которые выглядят как числа, всегда рассматриваются как указатели положения, независимо от установленных флажков.
<p>Исчерпывающее объяснение регулярных выражений выходит за рамки данной справки, но одним свойством, заслуживающим упоминания, является возможность создавать отрицательные выражения.  Предположим для примера, что нужно выбрать все строки или столбцы, исключая те, которые начинаются с "Total".  Это можно сделать так: <br>
<i>"^(?!Total)"</i>
Галочка (^) начинает соответствие с началом метки. Текст метки удовлетворяет заданному шаблону, только если следующий текст не <i>Total</i>.
<p>Регулярные выражения нельзя использовать со спецификациями ширины столбцов данных.
<p>По умолчанию при сопоставлении текста используется текст на самом дальнем внутреннем уровне (-1).
Вводите большие по величине отрицательные числа, чтобы двигаться вовне (вверх или влево) или положительные числа,
чтобы считать в направлении снаружи внутрь.  Обратите внимание, что некоторые таблицы имеют невидимые уровни между
теми, которые вы видите, поэтому может потребоваться проведение некоторых экспериментов, чтобы получить
правильный уровень.  Уровень 1 обычно является самым ближайшим внешним видимым уровнем.
<p>Поставьте переключатель <i>Печатать метки</i>, чтобы увидеть все метки в выбранном измерении.
Так как многие таблицы имеют скрытые метки, используйте это, чтобы увидеть структуру целиком.
<p>По умолчанию обрабатываются все таблицы заданных типов в выводе непосредственно предшествующей процедуры.  Выберите <i>Весь вывод</i>, чтобы обработать все выполненные ранее процедуры.
<h2>Поддиалог значимости</h2>
<p>Это диалоговое подокно уточняет выбор, сделанный в главном диалоговом окне, до тех ячеек, которые соответствуют заданным здесь критериям значимости.
В большинстве случаев критерии значимости будут использоваться в спецификации выбора "&lt;&lt;ALL>>" в главном диалоговом окне,
но если здесь выбрано подмножество, спецификации значимости применяются в этом подмножестве.
</p>
<p class="bullet">&bull; Это диалоговое подокно применимо только к Statistics версии 24 или новее и к выходным данным из настраиваемых таблиц (CTABLES),
где маркеры значимости показаны в основной таблице и относятся к простому типу (не APA).
</p>

<p><i>Выбор значимых ячеек:</i> Выберите <i>Все ячейки с маркером значимости</i>, чтобы выбрать все ячейки с любым маркером значимости.
Маркеры значимости - это специальные буквенные коды, которые появляются в ячейке</p>
<p>Другой вариант - можно задать конкретные маркеры значимости для выбора, вводя паттерн значимости.
Этот паттерн может быть простым списком маркеров столбцов.
Например, "AB" задает выбор только ячеек, где столбцы A или B указаны как существенно разные.
Буквенные коды показываются в заголовках столбцов, когда результаты значимости объединяются, а не выводятся в отдельной таблице.
Их можно использовать, чтобы сосредоточить внимание на нескольких конкретных категориях.
<p>

<p>Подтаблицы по столбцам используются, когда измерение столбца содержит вложенную спецификацию, такую как категория должности с полом (gender > jobcat)
или когда в этом измерении объединяются несколько категориальных переменных (jobcat + gender).
Можно далее указать, к каким подтаблицам будет применяться выбор, указав номера подтаблиц после каждого буквенного кода.
Например,
<i>A01B2</i> указывает, что только A-значимые ячейки должны быть выбраны в подтаблицах 0 и 1, и только B-значимые коды должны быть выбраны в подтаблице 2.
Можно идентифицировать подтаблицы в выводе, так как буквенные обозначения столбцов для значимости начинаются с (A) в таблице для каждой ее подтаблицы.
</p>

<p>Во вложенной таблице самое внутреннее измерение повторяется, поэтому, возможно, вы захотите применить выбор ко всем вложенным подтаблицам.
Однако если переменные объединяются по столбцам, смысл букв значимости будет различным в каждой подтаблице, и вам может понадобиться применить выбор только к определенным подтаблицам.
</p>
<p class="bullet">&bull; Нумерация подтаблиц начинается с 0.
С помощью этой записи можно указать до десяти подтаблиц.
</p>

<p><i>Уровень значимости:</i> В таблице можно показать один или два уровня значимости.
Если есть два уровня, более значимые значения указываются буквами верхнего регистра, а менее значимые - буквами нижнего регистра.
При выборе можно указать, что выбраны оба уровня или только один или другой.
Если в таблице есть только один уровень, выберите Оба или Верхний.</p>


<h2>Вспомогательный диалог Действия</h2>
<p>Поставьте переключатель <i>Скрыть выбранные строки или столбцы</i>, чтобы сделать эти элементы невидимыми.
Данный выбор нельзя объединить с любым другим действием.
<h3>Задание ширины столбца</h3>
<p>В поле ширины столбца введите число пунктов для применения ко всем выбранным столбцам или список чисел, по числу выбранных столбцов, чтобы задать индивидуальные значения ширины.  1 пункт - это 1/72 дюйма.
(Подсказка: чтобы увидеть текущую ширину столбца, активируйте таблицу двойным щелчком, щелкните по границе
столбца и чуть перетащите.)
<p>Шириной меток строк можно управлять, вводя положения меток строк, используя те же обозначения, что и для выбранных строк или столбцов, а также отдельные значения ширины или набор значений.
<h3>Применение стилей</h3>
Стили можно применять к ячейкам данных в таблице, меткам в выбранном измерении или к тому и другому вместе.  Выберите <i>Ячейки данных по условию</i> (в главном диалоговом окне), чтобы обработать только ячейки, удовлетворяющие условию.
<p>Условие - это выражение со значениями true/false, в котором значение ячейки представлено как x.
Например,<br>
<br>x &lt; .05 </br>
выбирает только ячейки данных, где значение ячейки меньше 0,05.
Выражение интерпретируется как код Python.
Можно использовать обычные логические операции и операции сравнения.
<i>abs(x)</i> - это абсолютное значение ячейки.
<p>
<i>i</i> обозначает номер строки или столбца в измерении, противоположном к измерению в SELECT.  Например<br>
i % 2 == 1<br>
(% является оператором деления по модулю в Python) выберет нечетные столбцы, если выбранным измерением являются
строки.
<p>
<i>ii</i> обозначает номер строки или столбца в измерении SELECT.  Выражение
<br>
ii % 2 == 1
<br>
можно использовать, чтобы применить стиль к нечетным строкам, если измерением в SELECT являются строки.
<p>
Всегда используйте точку (.) в качестве разделителя целой и дробной части числа, даже если в вашем регионе используется запятая.
<p>
Выберите стиль текста, его цвет, а также цвет фона, используя соответствующие элементы управления.  Цвета представляются тремя цифрами, первая для красного компонента, вторая для зеленого и третья для синего.  Значения должны быть между 0 (нет) и 255 (максимум).  Например, 0 0 0 представляет черный, 255 255 255 представляет белый, 255 0 0 представляет красный.  Желтый состоит из равных частей красного и зеленого.
<p>
Если у вас имеется дополнительная функция для применения к заданным ячейкам, вставьте ее как<br>
modulename.functionname<br>
Обратитесь к модулю с Python именем customstylefunctions.py за деталями того, как писать такие функции.
<p>Дополнительные функции могут иметь параметры.  Чтобы задать один или несколько параметров, заключите список параметров в круглые скобки, и напишите имена и значения параметров.
Например,<br>
customstylefunctions.stripeOddRows2(r=20,g=20,b=200)
<br>
применяет функцию stripeOddRows2 в модуле customstylefunctions.
Она получит три параметра r, g и b (для красного, зеленого и синего) со значениями 20, 20 и 200 соответственно.  Обратитесь к документации по любой конкретной дополнительной функции, чтобы узнать, какие параметры она принимает.  Имена параметров должны быть написаны в регистре, указанном в определении функции.
<p>Если значение параметра является строкой, заключите ее в одиночные кавычки, например,<br>
option='both'
<br>
<h3>Шаблоны таблиц</h3>
Шаблон таблиц можно применить к целой таблице, поставив флажок Применить шаблон таблиц и задав файл шаблона таблиц.  Файлы шаблонов таблиц имеют расширение stt.
Шаблон таблиц применяется ко всей таблице, независимо от установок в главном диалоговом окне.
<h3>Выбор правильных цветов</h3>
Выбор наилучших цветов для презентации зависит от ее цели и характеристик устройства, на котором она будет демонстрироваться.  Вы, возможно, захотите акцентировать внимание на конкретных строках и столбцах, или, возможно, захотите выделить типичные или необычные значения.  Наилучшая цветовая схема может варьироваться в зависимости от того, будет ли изображение выведено на экране компьютера, напечатано, или спроецировано.  Или могут быть корпоративные требования к цветовой схеме.
Вы можете получить совет по координатам RGB на сайте
<br><u>
http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer.html
</u>.
<br>Несмотря на того, что это сайт о картах, некоторые советы могут также оказаться полезными и для таблиц
(или для ваших диаграмм).
<p>Функции <i>customstylefunctions.qualitative</i> и <i>customstylefunctions.pastelqualitative</i> можно использовать для применения этих цветовых схем к столбцам таблицы.
<h2>Модуль customstylefunctions</h2>
Данный модуль, поставляемый вместе с командой SPSSINC MODIFY TABLES, содержит много функций, которые расширяют набор действий, показанных явно в этом диалоговом окне, и могут быть использованы с помощью поля <i>Применить дополнительную функцию</i>.
Вот список этих функций.
Комментарии в данном модуле дают детали их использования.
<ul>
<li>blankTableTriangle</li>
<li>boldIfEndsWithAtoZLetter</li>  
<li>colorCrosstabResiduals</li>  
<li>colorIfEndsWithAtoZLetter</li>
<li>generic</li>  
<li>hideFootnotes</li>  
<li>hideAllFootnotes</li>
<li>hideNonfinalRows</li>  
<li>HideRowBasedOnValues</li>
<li>makeSigCoefsBold</li>  
<li>moveColumnsToLayers</li>  
<li>moveColumnsToRows</li>  
<li>moveLayersToColumns</li>  
<li>moveLayersToRows</li>  
<li>moveRowDimension</li>  
<li>moveRowsToColumns</li>  
<li>moveRowsToLayers</li>  
<li>pastelqualitative</li>  
<li>qualitative</li>  
<li>reletter</li>
<li>roundToFormat</li>  
<li>SetAlignment</li>
<li>SetCellMargins</li>
<li>SetDecimalPlaces</li>
<li>SetLeadingZero</li>
<li>SetNumericFormat</li>  
<li>SetNumericFormatAndDecimals</li>  
<li>SetTwoDecimalPlaces</li>  
<li>showcorner</li>
<li>sortTable</li>
<li>spreadsig</li>
<li>stripeOddDataRows</li>  
<li>stripeOddRows</li>  
<li>stripeOddRows2</li>  
<li>transpose</li>  
<li>washColumnBackgrounds</li>  
<li>washColumns</li>  
<li>washColumnsBlue</li> 
</uL>
<h2>Дополнительные возможности</h2>
<p>
Этот диалог формирует синтаксис для команды расширения SPSSINC MODIFY TABLES. Чтобы вывести справку для этой команды, введите следующую команду:
</p>
<p class="codeblock">SPSSINC MODIFY TABLES /HELP.</p>
С помощью синтаксиса команд можно задать список подтипов, выводимых по отдельности.
<h2>Технические требования</h2>
<p>
Для этого диалогового окна требуются надстройка интеграции для Python и команда расширения SPSSINC MODIFY TABLES. 
</p>
<p style="font-size:80%;">Copyright IBM Corp. 1989, 2015</p>
</body>
</html>

