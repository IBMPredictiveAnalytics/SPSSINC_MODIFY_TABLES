<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>修改表</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>
<body>
<h1>修改表</h1>
“修改表”将显示样式和格式化应用于透视表。您可以
<ul>
<li>控制单个数据单元格以及行和列标签的外观。
<li>设置或隐藏特定列的宽度。
<li>透视表维。
</ul>
您可以在查看器中选择特定类型的表以便对其应用这些修改，并可以选择范围。
<p class="bullet">&bull;V19 中的轻量级表不受此命令影响，因为它们无法编辑。此限制不适用于更高版本。

<p>选择指定项由下列各项组成：<ul>
<li>要处理的表的类型。这些类型为 OMS 表子类型。</li>
<li>维：行或列（缺省值为列）。</li>
<li>特定行或列，包括所有行或列。</li>
<li>应用范围：应用于前一个命令或者应用于所有输出（缺省情况为应用于前一输出）。</li>
<li>可选的特定于值的选择条件，例如，单元格值必须大于 2。</li>
<li>带有显著性标记的单元格的可选选择</li>
</ul>
操作规范为：
<ul>
<li>隐藏指定的行或列。</li>
<li>设置列的宽度和/或行标签的宽度。</li>
<li>将字体样式设置为常规、粗体、斜体或粗斜体。</li>
<li>设置字体颜色。</li>
<li>设置背景色。</li>
<li>将定制操作应用于指定的单元格。</li>
</ul>
选择规范是在主对话框和“显著性”子对话框上建立的。操作规范是在“操作”子对话框上建立的。如果您不指定任何操作，或者如果选择条件找不到匹配的任何表，那么该命令将保持静默，不执行任何操作。

<h2>选择表、维以及行或列</h2>

<p>在<i>表子类型</i>字段中输入 OMS 表子类型。
确定子类型的方法是：右键单击表实例的大纲，然后选择<i>复制
OMS 子类型</i>，或者从<i>实用程序 > OMS 标识</i>中的列表中进行选择。输入 * 以选择所有子类型。</p>
<p>
选择<i>列</i>或<i>行</i>可以确定要处理的表的维。只能为列维设置宽度，但无论维是什么，都可以设置行标签宽度。
<p>
在<i>选定的列或行</i>中，输入要处理的特定行或列的空格分隔列表，或输入 "&lt;&lt;ALL&gt;&gt;" 以处理整个维（包括引号并大写 ALL）。可以使用数字位置或者括在引号内的标签文本来指定行或列。
<p>对于<i>文本匹配级别</i>，第一个（最外面的）行或列是 0。使用负数可以从末尾向后计数：-1 表示最后一个（最里面的）行或列。对于标签文本匹配，请将文本括在引号内。请精确匹配标签的大小写以及它包含的任何空格。可以组合使用数字指定项和文本指定项。例如，<br>
2 3 "Upper"<br>
选择行或列 2、3 以及标记为“Upper”的行或列。如果没有任何项与规范匹配，将忽略该规范。在表的最内级别对行或列进行计数。
<p>如果选中了<i>上面的文本是模式</i> ，那么上面的每个文本字段（&lt;&lt;ALL&gt;&gt; 除外）将被视为正则表达式。例如，<i>"Sig\."</i> 将匹配包含 <i>Sig.</i> 的任何标签文本。否则，标签将与指定的文本按字面匹配。作为正则表达式，这将匹配 <i>Asympt Sig.</i> 或 <i>Two-tailed Sig.</i>，但不匹配 <i>Asympt Sig</i>（无句点）。
作为纯文本，两者都不匹配。
可以使用任何 Python 正则表达式。模式区分大小写，并能感知语言环境。
<p>看起来像数字的项始终被视为位置，而与复选框设置无关。
<p>正则表达式的完整解释超出了此帮助的范围，但这里值得指出的一个特征是创建否定表达式的能力。例如，假设您要选择所有行或列，但以“Total”开头的行或列除外。这可以使用以下表达式来实现：<br>
<i>"^(?!Total)"</i>
插入标记 (^) 在标签开头处开始匹配。仅当下一个文本不是 <i>Total</i> 时，剩余部分才为 true。
<p>正则表达式不能与数据列宽度规范配合使用。

<p>匹配文本时，缺省情况下将使用最内级别 (-1) 的文本。
输入更多负数以向外移动（向上或向左），或输入正数以从外向内计数。请注意，某些表在您看到的内容之间存在不可视的级别，因此可能需要进行一些试验才能使级别正确。级别 1 通常是最外面的可视级别。

<p>选中<i>打印标签</i>可以查看所选维中的所有标签。
由于许多表都有隐藏的标签，因此使用此功能可以看到完整的结构。
<p>缺省情况下，将处理紧邻的先前过程输出中指定类型的所有表。选择<i>所有输出</i>以处理所有先前执行的过程。

<h2>显著性子对话框</h2>
<p>此子对话框将主对话框上进行的选择缩小到满足此处指定的显著性条件的那些单元格。
在大多数情况下，显著性条件将与主对话框上的 "&lt;&lt;ALL>>" 选择规范配合使用，但如果其中选择了子集，那么将在该子集内应用显著性规范。
</p>
<p class="bullet">&bull; 此子对话框仅适用于 Statistics V24 或更高版本以及来自符合以下条件的定制表 (CTABLES) 的输出：显著性标记显示在主表中，并且是简单（非 APA）类型。</p>

<p><i>显著单元选择：</i>选择<i>带有显著性标记的所有单元格</i>以选择带有任何显著性标记的所有单元格。显著性标记是显示在单元格中的特殊字母代码</p>
<p>或者，您可以通过输入显著性模式来指定要选择的特定显著性标记。该模式可以是列标记的简单列表。
例如，"AB" 将仅选择标有字母 A 或 B 的列被列为显著不同的单元格。当显著性结果被合并而不是显示在单独的表中时，字母代码会显示在列标题中。当您希望关注几个特定类别时，可以使用此方法。<p>

<p>当列维具有嵌套规范（如性别中的作业类别 (gender > jobcat)）或在该维中堆积多个分类变量 (jobcat + gender) 时，将发生跨列的子表。
您可以通过列出每个字母代码后的子表编号来进一步指定选择应用于哪些子表。例如，<i>A01B2</i> 表示在子表 0 和 1 中仅应选择 A 显著的单元格，而在子表 2 中仅应选择 B 显著的代码。您可以在输出中识别子表，因为在整个表中，对于每个子表，显著性的列字母标记将从 (A) 重新开始。</p>

<p>在嵌套表中，最内层的维将重复，因此您可能希望选择应用于所有嵌套子表。但是，如果变量堆积在各个列中，那么显著性字母的含义在每个子表中都将不同，并且您可能希望选择仅应用于特定子表。
</p>
<p class="bullet">&bull; 子表编号从 0 开始。使用此表示法最多可引用 10 个子表。</p>

<p><i>显著性水平：</i>一个表中可以显示一个或两个显著性水平。如果有两个显著性水平，那么显著性更高的值以大写字母表示，显著性更低的值以小写表示。在选择时，您可以指定选择两个级别，或仅选择其中一个级别。如果表中只有一个级别，请选择“两者”或“大写”。</p>


<h2>操作子对话框</h2>
<p>选中<i>隐藏选定的行或列</i>以使这些项不可视。
此选项不能与任何其他操作组合在一起。

<h3>设置列宽</h3>
<p>在列宽字段中，输入一个数字（以磅为单位）以应用于所有选定列，或输入数字列表（值的数量与选择的列数相等）以指定个别宽度。一磅是 1/72 英寸。
（提示：要查看列的当前宽度，请双击表以将其激活，单击列边框，并稍加拖动。）
<p>可以使用与选择行或列以及单个宽度或一组宽度相同的表示法，通过输入行标签位置来控制行标签宽度。

<h3>应用样式</h3>
样式可以应用于表的数据单元格和/或选定维中的标签。选择<i>条件上的数据单元格</i>（在主对话框上）以仅处理满足条件的数据单元格。
<p>条件是一个 true/false 表达式，其中单元格值表示为 x。例如，<br>
<br>x &lt; .05 </br>
将仅选择单元格值小于 .05 的数据单元格。
该表达式被解释为 Python 代码。可以使用普通逻辑和比较运算符。<i>abs(x)</i> 是单元格的绝对值。
<p>
<i>i</i> 表示与 SELECT 维相反的维中的行或列号。例如<br>
i % 2 == 1<br>
（% 是 Python 求余运算符）将在选定维是行时选择奇数编号的列。
<p>
<i>ii</i> 表示 SELECT 维中的行或列。指定
<br>
ii % 2 == 1
<br>
可用于在 SELECT 维是行时将样式应用于奇数编号的行。
<p>
请在指定小数值时始终使用点 (.)，即使在通常以逗号为小数点符号的语言环境中也是如此。
<p>
使用相应控件选择文本样式、颜色和背景色。颜色表示为三个数字，分别用于红色、绿色和蓝色成分。值必须在 0（无）和 255（最大值）之间。例如，0 0 0 为黑色，255 255 255 为白色，255 0 0 为红色。黄色由等量的红色和绿色构成。
<p>
如果您要将定制函数应用于指定的单元格，请在此处输入如下内容：<br>
modulename.functionname<br>
有关如何编写此类函数的详细信息和示例，请参阅 Python 模块 customstylefunctions.py。
<p>定制函数可以有参数。要指定一个或多个参数，请将参数列表括在圆括号内，并编写参数名称和值。
例如，<br>
customstylefunctions.stripeOddRows2(r=20,g=20,b=200)
<br>
将应用 customstylefunctions 模块中的 stripeOddRows2 函数。它将获得三个参数，即 r、g 和 b（分别表示红色、绿色和蓝色），其值分别为 20、20 和 200。请查阅任何特定定制函数的文档以了解它接受的参数。参数名称必须按函数定义中所指定的大小写进行书写。
<p>如果参数值是字符串，请将其括在单引号内，例如：<br>
option='both'
<br>
<h3>表外观</h3>
您可以通过选中“应用表外观”并指定表外观文件来将表外观应用于整个表。表外观文件的扩展名为 stt。
无论主对话框上的设置如何，表外观都应用于整个表。
<h3>选择正确的颜色</h3>
演示文稿的最佳颜色取决于其用途以及将进行查看的设备的特征。您可能始终希望突显特定行或列，或者您可能希望突显典型或不寻常的值。您的最佳颜色方案可能根据是在屏幕上查看、打印出来或进行投影而有所不同。或者可能需要企业颜色方案。
您可以在以下网址获取建议和 RGB 坐标：<br><u>
http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer.html
</u>。
<br>虽然此站点是关于映射的，但某些建议也可能对表（或图表）很有用。
<p>函数 <i>customstylefunctions.qualitative</i> 和 <i>customstylefunctions.pastelqualitative</i> 可用于将这些颜色方案应用于表的列。
<h2>customstylefunctions 模块</h2>
此模块（在 SPSSINC MODIFY TABLES 命令中随附）包含许多函数，这些函数扩展了此对话框中明确显示的操作集，并可通过<i>应用定制函数</i>字段使用。
以下是这些函数的列表。
模块中的注释显示了用法详细信息。
<ul>
<li>blankTableTriangle</li>
<li>boldIfEndsWithAtoZLetter</li>  
<li>colorCrosstabResiduals</li>  
<li>colorIfEndsWithAtoZLetter</li>
<li>generic</li>  
<li>hideFootnotes</li>  
<li>hideAllFootnotes</li>
<li>hideNonfinalRows</li>  
<li>HideRowBasedOnValues</li>
<li>makeSigCoefsBold</li>  
<li>moveColumnsToLayers</li>  
<li>moveColumnsToRows</li>  
<li>moveLayersToColumns</li>  
<li>moveLayersToRows</li>  
<li>moveRowDimension</li>  
<li>moveRowsToColumns</li>  
<li>moveRowsToLayers</li>  
<li>pastelqualitative</li>  
<li>qualitative</li>  
<li>reletter</li>
<li>roundToFormat</li>  
<li>SetAlignment</li>
<li>SetCellMargins</li>
<li>SetDecimalPlaces</li>
<li>SetLeadingZero</li>
<li>SetNumericFormat</li>  
<li>SetNumericFormatAndDecimals</li>  
<li>SetTwoDecimalPlaces</li>  
<li>showcorner</li>
<li>sortTable</li>
<li>spreadsig</li>
<li>stripeOddDataRows</li>  
<li>stripeOddRows</li>  
<li>stripeOddRows2</li>  
<li>transpose</li>  
<li>washColumnBackgrounds</li>  
<li>washColumns</li>  
<li>washColumnsBlue</li> 
</uL>
<h2>其他功能部件</h2>
<p>
此对话框将生成 SPSSINC MODIFY TABLES 扩展命令的语法。要显示此命令的帮助，请运行以下语法：</p>
<p class="codeblock">SPSSINC MODIFY TABLES /HELP。</p>
在命令语法中，可以指定各自括在引号内的子类型的列表。

<h2>要求</h2>
<p>
此对话框需要 Integration Plug-In for Python 和 SPSSINC MODIFY TABLES 扩展命令。</p>
<p style="font-size:80%;">Copyright IBM Corp. 1989, 2015</p>
</body>
</html>

