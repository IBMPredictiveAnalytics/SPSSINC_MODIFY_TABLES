<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>テーブルを変更</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>
<body>
<h1>テーブルの変更</h1>
「テーブルの変更」では、表示スタイルおよび書式がピボット テーブルに適用されます。以下を行うことができます:<ul>
<li>各データ セルと行および列のラベルの外観を制御する。
<li>特定の列の幅を設定またはそれらの列を非表示にする。
<li>テーブルのディメンションを旋回させる。
</ul>
これらの変更および範囲を適用する特定の種類のテーブルをビューアで選択できます。  
<p class="bullet">&bull;バージョン 19 の軽量テーブルは編集不可であるため、このコマンドの影響を受けません。この制限は、それ以降のバージョンには適用されません。

<p>選択の指定は次の項目で構成されています。<ul>
<li>処理するテーブルの種類。種類は OMS テーブル サブタイプです。</li>
<li>ディメンション: 行または列 (デフォルトは列です)。</li>
<li>特定の行または列 (すべての場合もあり)。</li>
<li>アプリケーションの範囲: 先行コマンドまたはすべての出力 (デフォルトは先行出力です)。</li>
<li>セル値が 2 より大きくなければならないなど、オプションの値固有の選択基準。</li>
<li>有意マーカーが付いたセルの任意選択</li>
</ul>
操作の指定は次のとおりです。
<ul>
<li>指定した行または列を非表示にする。</li>
<li>列の幅および行ラベルの幅を設定する。</li>
<li>フォント スタイルを通常、太字、斜体、または太字斜体に設定する。</li>
<li>文字の色を設定する。</li>
<li>背景色を設定する。</li>
<li>ユーザー指定の操作を指定したセルに適用する。</li>
</ul>
選択の指定は、メイン ダイアログおよび「有意水準」サブダイアログで行います。操作の指定は「操作」サブダイアログで行います。操作を指定しない場合または選択基準を満たすテーブルがない場合、コマンドは何も実行しません。
<h2>テーブル、ディメンション、および行または列の選択</h2>

<p>OMS テーブルのサブタイプを<i>「テーブルのサブタイプ」</i>フィールドに入力します。サブタイプを検索するには、テーブルのインスタンスのアウトラインを右クリックして<i>「OMS テーブルのサブタイプをコピー」</i>を選択するか、または<i>「ユーティリティー」>「OMS 識別子」</i>のリストから選択します。すべてのサブタイプを選択するには、* を入力します。</p>
<p>
処理するテーブルのディメンションを決定するには、<i>「列」</i>または<i>「行」</i>を選択します。幅は列ディメンションにのみ設定できますが、ディメンションに関係なく行ラベルの幅を設定できます。
<p>
<i>「選択した列または行」</i>に処理する特定の行または列の空白区切りリストを入力するか、"&lt;&lt;ALL&gt;&gt;" を入力してディメンション全体を処理します (引用符および大文字の ALL を入力)。行または列は数値の位置または引用符に囲んだラベル テキストで指定できます。<p><i>「テキスト マッチングのレベル」</i>では、最初 (一番外側) の行または列が 0 になります。負の数を使用すると、終わりから逆にカウントします。-1 は最後 (一番内側) の行または列です。ラベルのテキスト マッチングの場合、テキストを引用符で囲みます。含まれるラベルおよび空白の大文字小文字は正確に区別します。数値とテキストの指定は組み合わせることができます。たとえば、<br>
2 3 "Upper"<br>
は、行または列 2、3 と "Upper" というラベルの付いた行またはラベルを選択します。項目が指定と一致しない場合、無視されます。行または列は、テーブルの最も内側のレベルでカウントされます。
<p><i>「上記のテキストがパターン」</i>がオンの場合、(&lt;&lt;ALL&gt;&gt; を除く) 上記のテキスト フィールドが正規表現として扱われます。例えば <i>"Sig\."</i> は、<i>Sig.</i> を含むラベル テキストと一致します。そうでない場合、ラベルは指定した文字どおりのテキストと一致します。正規表現では、<i>Asympt Sig.</i> や <i>Two-tailed Sig.</i> と一致しますが、<i>Asympt Sig</i> (ピリオドなし) とは一致しません。
テキスト形式では、いずれとも一致しません。任意の Python 正規表現を使用できます。パターンは大文字と小文字を区別し、ロケールを認識します。
<p>数値のような項目は、チェック ボックスの設定に関係なく位置として処理されます。
<p>正規表現についての詳細な説明はこのヘルプの対象外ですが、負の式を作成する機能については、ここで説明します。例えば、"Total" で始まる行または列を除いたすべての行または列を選択するとします。以下の方法で可能です。<br>
<i>"^(?!Total)"</i>
カラット (^) は、ラベルの先頭で比較を開始します。次のテキストが <i>Total</i> でない場合にのみ、残りの部分が true となります。
<p>正規表現を、データ列の幅の指定と一緒に使用することはできません。

<p>テキストと一致する場合、デフォルトでは最も内側のレベル (-1) のテキストが使用されます。負の数を入力すると外側 (上または左) に移動し、正の数を入力すると外側から内側にカウントします。一部のテーブルでは表示されないレベルがある場合があるため、レベルを修正するには検証が必要な場合があります。通常、レベル 1 が表示可能な最も外側のレベルです。

<p>選択したディメンションのすべてのラベルを表示するには、<i>「ラベルの印刷」</i>をオンにします。多くのテーブルに非表示のラベルがあるため、完全な構造を参照するには、このオプションを使用してください。
<p>デフォルトでは、直前のプロシージャの出力内の指定した種類のすべてのテーブルが処理されます。<i>「すべての出力」</i>を選択すると、以前に実行したすべてのプロシージャが処理されます。
<h2>「有意水準」サブダイアログ</h2>
<p>このサブダイアログは、メイン ダイアログで行った選択を、ここで指定した有意性の基準を満たすセルに絞り込みます。
ほとんどの場合、有意性の基準はメイン ダイアログでの選択の指定「&lt;&lt;ALL>>」とともに使用しますが、そこでサブセットを選択してある場合は、その中で有意性の指定が適用されます。
</p>
<p class="bullet">&bull; このサブダイアログは、Statistics バージョン 24 以降に適用されるほか、有意マーカーがメイン テーブルに示され、かつ単純 (非 APA) タイプのカスタム テーブル (CTABLES) からの出力のみに適用されます。</p>

<p><i>有意セルの選択:</i> <i>「有意マーカーが付いたすべてのセル」</i>を選択すると、有意マーカーが付いたすべてのセルが選択されます。有意マーカーは、セルに示される特殊文字の符号です。</p>
<p>別の方法として、有意パターンを入力することによって、選択対象とする特定の有意マーカーを指定することもできます。このパターンは、列マーカーの単純なリストにすることができます。
例えば「AB」の場合は、A または B の文字が付いている列のみが、有意に異なるものとしてリストされているセルのみを選択します。有意かどうかの結果が別のテーブルに示されているのではなく、マージされている場合は、文字の符号が列ヘッダーに示されます。この機能は、いくつかの特定のカテゴリに焦点を当てたい場合に使用できます。<p>

<p>列にまたがるサブテーブルは、列ディメンションにおいて性別の中に職種がある (gender > jobcat) など、指定がネストされている場合、またはそのディメンションで複数のカテゴリ変数が積み上げられている場合 (jobcat + gender) に発生します。
さらに、それぞれの文字符号の後にサブテーブル番号をリストすることによって、選択を適用するサブテーブルを指定できます。例えば <i>A01B2</i> は、サブテーブル 0 および 1 では A の有意セルのみを選択し、サブテーブル 2では B の有意符号のみを選択するように指定します。サブテーブルごとに、テーブル全体で有意性の文字を示す列が (A) から再開するため、出力の中のサブテーブルを識別できます。</p>

<p>ネストされたテーブルでは、最も内側のディメンションが反復されるため、ネストされたすべてのサブテーブルにわたって選択を適用する必要があります。ただし、変数が列をまたいで積み上げられている場合は、有意符号の意味がサブテーブルごとに異なるため、選択を特定のサブテーブルのみに適用してください。
</p>
<p class="bullet">&bull; サブテーブルの番号は 0 から始まります。この表記を使用して、10 件までのサブテーブルを参照できます。</p>

<p><i>有意水準:</i> 1 つまたは 2 つの有意水準をテーブルに表示できます。2 つある場合は、有意性の高い値が大文字で示され、有意性が低い値が小文字で示されます。選択時には、両方のレベルを選択するか、一方のみを選択するかを指定できます。テーブルにレベルが 1 つしかない場合は、「両方の水準」または「上限」を選択してください。</p>


<h2>「操作」サブダイアログ</h2>
<p>これらの項目を非表示にするには、<i>「選択した行または列を非表示にする」</i> をオンにします。このオプションを他の操作と組み合わせることはできません。

<h3>列幅の設定</h3>
<p>「列幅」フィールドに、選択したすべての列に適用する数値 (ポイント)、または数値のリストを選択した列と同じ数だけ入力し、各列の幅を指定します。1 ポイントは 1/72 インチです。(ヒント: 列の現在の幅を確認するには、テーブルをダブルクリックしてアクティブにし、列の境界線をクリックして少しだけドラッグします。)
<p>行または列、および 1 つの幅または複数の幅を選択するための表記と同じものを使用して、行ラベルの位置を入力して、行ラベルの幅を制御します。

<h3>スタイルの適用</h3>
スタイルは、テーブルのデータ セル、選択したディメンションのラベル、または両方に適用されます。メイン ダイアログで<i>「条件のデータ セル」</i>を選択すると、条件を満たすデータ セルだけが処理されます。
<p>条件は、セル値を x と表した true/false 式です。たとえば、<br>
<br>x &lt; .05 </br>
は、セル値が .05 より小さいデータ セルだけを選択します。式は Python コードとして解釈されます。通常の論理演算子および比較演算子を使用できます。<i>abs(x)</i> はセルの絶対値です。
<p>
<i>i</i> は、SELECT ディメンションとは逆のディメンションの行番号または列番号を示します。以下に例を示します。<br>
i % 2 == 1<br>
(% は Python の剰余演算子) は、選択したディメンションが行であるとすると、奇数番号の列を選択します。
<p>
<i>i</i> は、SELECT ディメンションの行または列を示します。以下のように指定した場合、
<br>
ii % 2 == 1
<br>
SELECT ディメンションが行であるとすると、奇数番号の行にスタイルが適用されます。
<p>
ご使用のロケールでコンマが通常の小数点記号である場合でも、小数点を指定する場合は必ずドット (.) を使用してください。
<p>
該当するコントロールを使用して、テキストのスタイル、色、背景色を選択します。色は 3 つの数値で指定します。それぞれ赤、緑、青の要素に対応します。値は 0 (なし) から最大値の 255 の間である必要があります。例えば、0 0 0 は黒、255 255 255 は白、255 0 0 は赤です。黄色は、赤と緑を同じ値にして構成します。
<p>
指定したセルにカスタム関数を適用する場合は、ここに以下のように入力します。<br>
modulename.functionname<br>
詳細およびこうした関数の作成方法を示す例については、Python モジュール customstylefunctions.py を参照してください。
<p>カスタム関数にはパラメータを指定できます。1 つまたは複数のパラメータを指定するには、パラメータのリストを括弧で囲み、パラメータ名と値を入力します。たとえば、<br>
customstylefunctions.stripeOddRows2(r=20,g=20,b=200)
<br>
は、customstylefunctions モジュールの stripeOddRows2 関数を適用します。この関数では 3 つのパラメータ r、g、および b (赤、緑、青) の値がそれぞれ 20、20、および 200 となります。指定できるパラメータについては、特定のカスタム関数の資料を参照してください。パラメータ名は、関数定義で指定されたとおりに大文字と小文字を区別して記述する必要があります。
<p>パラメータ値が文字列の場合、文字列を単一引用符で囲みます。例を示します。<br>
option='both'
<br>
<h3>テーブルルック</h3>
「テーブル ルックを適用」をオンにしてテーブル ルック ファイルを指定すると、テーブル ルックをテーブル全体に適用できます。テーブル ルック ファイルの拡張子は stt です。テーブル ルックは、メイン ダイアログの設定に関係なく、テーブル全体に適用されます。
<h3>適切な色の選択</h3>
表示するのに最適な色は、表示する目的とデバイスの特性によって異なります。たいていの場合は、特定の行または列を強調したり、通常の値、または通常とは異なる値を強調したりする必要があるものです。最適な色のスキーマは、画面に表示するか、印刷するか、プロジェクタで投影するかで異なります。また、会社のカラー スキーマを必要とする場合もあります。指針や RGB 座標については、次のサイトを参照してください。
<br><u>
http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer.html
</u>
<br>このサイトは地図に関するものですが、いくつかのアドバイスがテーブルまたはグラフを作成するうえで役立つ場合があります。
<p>関数 <i>customstylefunctions.qualitative</i> および <i>customstylefunctions.pastelqualitative</i> を使用して、これらのカラー スキーマをテーブルの列に適用できます。
<h2>customstylefunctions モジュール</h2>
SPSSINC MODIFY TABLES コマンドに付属するこのモジュールには、このダイアログに明示的に表示される一連の操作を拡張する多くの関数が含まれ、<i>「カスタム関数を適用」</i> フィールドで使用できます。以下に示すのは、この関数の一覧です。モジュールのコメントは、使用方法の詳細を示しています。
<ul>
<li>blankTableTriangle</li>
<li>boldIfEndsWithAtoZLetter</li>  
<li>colorCrosstabResiduals</li>  
<li>colorIfEndsWithAtoZLetter</li>
<li>generic</li>  
<li>hideFootnotes</li>  
<li>hideAllFootnotes</li>
<li>hideNonfinalRows</li>  
<li>HideRowBasedOnValues</li>
<li>makeSigCoefsBold</li>  
<li>moveColumnsToLayers</li>  
<li>moveColumnsToRows</li>  
<li>moveLayersToColumns</li>  
<li>moveLayersToRows</li>  
<li>moveRowDimension</li>  
<li>moveRowsToColumns</li>  
<li>moveRowsToLayers</li>  
<li>pastelqualitative</li>  
<li>qualitative</li>  
<li>reletter</li>
<li>roundToFormat</li>  
<li>SetAlignment</li>
<li>SetCellMargins</li>
<li>SetDecimalPlaces</li>
<li>SetLeadingZero</li>
<li>SetNumericFormat</li>  
<li>SetNumericFormatAndDecimals</li>  
<li>SetTwoDecimalPlaces</li>  
<li>showcorner</li>
<li>sortTable</li>
<li>spreadsig</li>
<li>stripeOddDataRows</li>  
<li>stripeOddRows</li>  
<li>stripeOddRows2</li>  
<li>transpose</li>  
<li>washColumnBackgrounds</li>  
<li>washColumns</li>  
<li>washColumnsBlue</li> 
</uL>
<h2>その他の機能</h2>
<p>
このダイアログは、SPSSINC MODIFY TABLES 拡張コマンドのシンタックスを生成します。このコマンドのヘルプを表示するには、次のシンタックスを実行します。
</p>
<p class="codeblock">SPSSINC MODIFY TABLES /HELP</p>
コマンド シンタックスで、それぞれ引用符で囲んだサブタイプのリストを指定できます。
<h2>要件</h2>
<p>
このダイアログには Integration Plug-In for Python と SPSSINC MODIFY TABLES 拡張コマンドが必要です。
</p>
<p style="font-size:80%;">Copyright IBM Corp. 1989, 2015</p>
</body>
</html>

